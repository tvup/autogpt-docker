apiVersion: apps/v1
kind: Deployment
metadata:
  name: app
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
    spec:
      containers:
        - name: app
          command: [ "gotty" ]
          args: [ "--port", "50001", "--permit-write", "--title-format", "AutoGPT Terminal", "bash", "-c", "python -m autogpt" ]
          resources: { }
          tty: true
          image: registry.digitalocean.com/torben-it-registry/autogpt
          env:
            - name: "PORT"
              value: "50001"
            - name: CUSTOM_SEARCH_ENGINE_ID
              valueFrom:
                secretKeyRef:
                  name: app-secrets
                  key: CUSTOM_SEARCH_ENGINE_ID
            - name: ELEVENLABS_API_KEY
              value: ${ELEVENLABS_API_KEY}
            - name: ELEVENLABS_VOICE_1_ID
              value: ${ELEVENLABS_VOICE_1_ID}
            - name: ELEVENLABS_VOICE_2_ID
              value: ${ELEVENLABS_VOICE_2_ID}
            - name: EXECUTE_LOCAL_COMMANDS
              value: ${EXECUTE_LOCAL_COMMANDS}
            - name: FAST_LLM_MODEL
              value: ${FAST_LLM_MODEL}
            - name: GOOGLE_API_KEY
              valueFrom:
                secretKeyRef:
                  name: app-secrets
                  key: GOOGLE_API_KEY
            - name: HUGGINGFACE_API_TOKEN
              valueFrom:
                secretKeyRef:
                  name: app-secrets
                  key: HUGGINGFACE_API_TOKEN
            - name: IMAGE_PROVIDER
              value: ${IMAGE_PROVIDER}
            - name: MEMORY_BACKEND
              value: ${MEMORY_BACKEND}
            - name: OPENAI_API_KEY
              valueFrom:
                secretKeyRef:
                  name: app-secrets
                  key: OPENAI_API_KEY
            - name: OPENAI_AZURE_API_BASE
              value: ${OPENAI_AZURE_API_BASE}
            - name: OPENAI_AZURE_API_VERSION
              value: ${OPENAI_AZURE_API_VERSION}
            - name: OPENAI_AZURE_DEPLOYMENT_ID
              value: ${OPENAI_AZURE_DEPLOYMENT_ID}
            - name: PINECONE_API_KEY
              valueFrom:
                secretKeyRef:
                  name: app-secrets
                  key: PINECONE_API_KEY
            - name: PINECONE_ENV
              value: ${PINECONE_ENV}
            - name: PULSE_SERVER
              value: unix:/run/user/1000/pulse/native
            - name: RAPID_API_KEY
              valueFrom:
                secretKeyRef:
                  name: app-secrets
                  key: RAPID_API_KEY
            - name: REDIS_HOST
              value: ${REDIS_HOST}
            - name: REDIS_PASSWORD
              value: ${REDIS_PASSWORD}
            - name: REDIS_PORT
              value: ${REDIS_PORT}
            - name: RESTRICT_TO_WORKSPACE
              value: ${RESTRICT_TO_WORKSPACE}
            - name: SMART_LLM_MODEL
              value: ${SMART_LLM_MODEL}
            - name: USE_AZURE
              value: ${USE_AZURE}
            - name: USE_MAC_OS_TTS
              value: ${USE_MAC_OS_TTS}
            - name: U_COOKIE
              valueFrom:
                secretKeyRef:
                  name: app-secrets
                  key: U_COOKIE
            - name: WIPE_REDIS_ON_START
              value: ${WIPE_REDIS_ON_START}
      restartPolicy: Always
      terminationGracePeriodSeconds: 60
status: {}
